"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8363],{18363:(s,e,t)=>{t.r(e),t.d(e,{default:()=>C});var a=t(95155),r=t(12115),l=t(66695),i=t(30285),m=t(58127),d=t(77223),c=t(37648),n=t(50172),o=t(31550),x=t(18046),u=t(54165),h=t(46102),p=t(66424),f=t(59434),j=t(27600),g=t(56104),N=t(35317),b=t(83013),y=t(43081),w=t(68856),k=t(26126),v=t(30688);let E=r.lazy(()=>t.e(1372).then(t.bind(t,21372)));function D(){return(0,a.jsxs)("div",{className:"grid gap-4 py-4 max-h-[60vh] sm:max-h-[65vh] overflow-y-auto pr-3",children:[(0,a.jsx)(w.E,{className:"h-9 sm:h-10 w-full"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[(0,a.jsx)(w.E,{className:"h-9 sm:h-10 w-full"}),(0,a.jsx)(w.E,{className:"h-9 sm:h-10 w-full"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[(0,a.jsx)(w.E,{className:"h-9 sm:h-10 w-full"}),(0,a.jsx)(w.E,{className:"h-9 sm:h-10 w-full"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[(0,a.jsx)(w.E,{className:"h-9 sm:h-10 w-full"}),(0,a.jsx)(w.E,{className:"h-9 sm:h-10 w-full"})]}),(0,a.jsx)(w.E,{className:"h-16 sm:h-20 w-full"})]})}function C(s){let{selectedDate:e,selectedSubjectFilter:t}=s,{currentUser:w}=(0,j.A)(),[C,H]=(0,r.useState)([]),[M,T]=(0,r.useState)(!0),[A,P]=(0,r.useState)({priority:"medium",status:"pending",duration:1,day:e.getDay(),startHour:9,subject:y.yo[0].id}),[S,z]=(0,r.useState)(!1),_=Array.from({length:15},(s,e)=>e+8);(0,r.useEffect)(()=>{P(s=>({...s,day:e.getDay()}))},[e]),(0,r.useEffect)(()=>{if(!w||!g.db){H([]),T(!1);return}T(!0);let s=(0,N.rJ)(g.db,"users",w.uid,"plannerTasks"),a=e.getDay(),r=[(0,N._M)("day","==",a)];t&&"all"!==t&&r.push((0,N._M)("subject","==",t));let l=(0,N.P)(s,...r),i=(0,N.aQ)(l,s=>{let e=[];s.forEach(s=>{e.push({id:s.id,...s.data()})}),e.sort((s,e)=>s.startHour-e.startHour),H(e),T(!1)},s=>{console.error("Error fetching tasks for DayView: ",s),T(!1)});return()=>i()},[w,e,t]);let G=async()=>{if(!w||!g.db)return;if(!A.title||!A.subject||void 0===A.startHour||void 0===A.duration)return void alert("Please fill in all required fields: Title, Subject, Start Time, and Duration.");let s={userId:w.uid,title:A.title,subject:A.subject,topic:A.topic||"",description:A.description||"",duration:Number(A.duration)||1,priority:A.priority||"medium",status:"pending",day:e.getDay(),startHour:Number(A.startHour)};try{await (0,N.gS)((0,N.rJ)(g.db,"users",w.uid,"plannerTasks"),s),w.uid&&await (0,v.T)(w.uid),P({title:"",topic:"",description:"",priority:"medium",status:"pending",duration:1,day:e.getDay(),startHour:9,subject:y.yo[0].id}),z(!1)}catch(s){console.error("Error creating task: ",s),alert("Failed to create task. Please try again.")}},Z=async s=>{if(!w||!g.db)return;let e=C.find(e=>e.id===s);if(!e)return;let t="completed"===e.status?"pending":"completed";try{await (0,N.mZ)((0,N.H9)(g.db,"users",w.uid,"plannerTasks",s),{status:t}),"completed"===t&&w.uid&&await (0,v.T)(w.uid)}catch(s){console.error("Error updating task status: ",s)}},$=async s=>{if(w&&g.db&&window.confirm("Are you sure you want to delete this task?"))try{await (0,N.kd)((0,N.H9)(g.db,"users",w.uid,"plannerTasks",s)),w.uid&&await (0,v.T)(w.uid)}catch(s){console.error("Error deleting task: ",s)}},F=s=>{let e=(0,y.nl)(s.subject),t=(0,y.kO)(s.priority),r=(0,y.DD)(s.startHour+s.duration);return(0,a.jsx)(h.Bc,{children:(0,a.jsxs)(h.m_,{delayDuration:300,children:[(0,a.jsx)(h.k$,{asChild:!0,children:(0,a.jsxs)(l.Zp,{className:(0,f.cn)("mb-2 sm:mb-3 shadow-md border transition-all duration-200 ease-out transform hover:shadow-lg hover:scale-[1.01]",e.color,"completed"===s.status?"opacity-60 line-through":""),children:[(0,a.jsxs)(l.aR,{className:"pb-1.5 sm:pb-2 pt-2 sm:pt-3 px-2 sm:px-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start gap-1 sm:gap-2",children:[(0,a.jsx)(l.ZB,{className:(0,f.cn)("text-sm sm:text-base font-semibold leading-tight break-words",e.textColor),title:s.title,children:s.title}),(0,a.jsxs)("div",{className:"flex items-center space-x-0.5 sm:space-x-1 shrink-0",children:[(0,a.jsx)(i.$,{variant:"ghost",size:"icon",className:"h-5 w-5 sm:h-6 sm:w-6",onClick:()=>Z(s.id),title:"completed"===s.status?"Mark pending":"Mark completed",children:"completed"===s.status?(0,a.jsx)(m.A,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-green-600"}):(0,a.jsx)(m.A,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 opacity-50 hover:opacity-100"})}),(0,a.jsx)(i.$,{variant:"ghost",size:"icon",className:"h-5 w-5 sm:h-6 sm:w-6",onClick:()=>$(s.id),title:"Delete task",children:(0,a.jsx)(d.A,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-red-500 hover:text-red-700"})})]})]}),(0,a.jsxs)("div",{className:(0,f.cn)("text-xs opacity-90",e.textColor),children:[(0,a.jsx)("span",{className:"font-medium",children:e.name}),s.topic&&(0,a.jsxs)("span",{className:"ml-1 break-all",children:[" - ",s.topic]})]})]}),(0,a.jsxs)(l.Wu,{className:"px-2 sm:px-3 pb-2 sm:pb-3 text-xs",children:[s.description&&(0,a.jsx)("p",{className:(0,f.cn)("mb-1.5 sm:mb-2 opacity-80 break-words",e.textColor),children:s.description}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-1 sm:gap-2",children:[(0,a.jsxs)("div",{className:(0,f.cn)("flex items-center opacity-80",e.textColor),children:[(0,a.jsx)(c.A,{className:"h-3 w-3 mr-1"}),(0,a.jsxs)("span",{children:[(0,y.DD)(s.startHour)," (",s.duration," ",1===s.duration?"hr":"hrs",")"]})]}),(0,a.jsx)(k.E,{variant:t.variant,className:(0,f.cn)("mt-1 sm:mt-0 text-[10px] sm:text-xs px-1.5 py-0.5",t.className),children:t.text})]})]})]})}),(0,a.jsxs)(h.ZI,{side:"top",align:"center",className:"w-64",children:[(0,a.jsx)("p",{className:"font-semibold text-sm",children:s.title}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Subject: ",e.name]}),s.topic&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Topic: ",s.topic]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Time: ",(0,y.DD)(s.startHour)," - ",r]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Duration: ",s.duration," hr(s)"]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground capitalize",children:["Priority: ",s.priority]}),s.description&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Notes: ",s.description]})]})]})},s.id)};if(M)return(0,a.jsxs)("div",{className:"flex-grow flex flex-col items-center justify-center p-4 sm:p-6 bg-muted/20 rounded-lg",children:[(0,a.jsx)(n.A,{className:"h-10 w-10 sm:h-12 sm:w-12 animate-spin text-primary mb-3 sm:mb-4"}),(0,a.jsxs)("p",{className:"text-muted-foreground text-sm sm:text-base",children:["Loading tasks for ",(0,b.GP)(e,"EEEE, MMM d"),"..."]})]});if(!w)return(0,a.jsx)(l.Zp,{className:"border-dashed flex-grow flex flex-col items-center justify-center min-h-[300px] sm:min-h-[400px] bg-muted/20 p-4",children:(0,a.jsxs)(l.Wu,{className:"pt-6 text-center",children:[(0,a.jsx)(o.A,{className:"h-8 w-8 sm:h-10 sm:w-10 text-primary mx-auto mb-3 sm:mb-4"}),(0,a.jsx)("h3",{className:"text-lg sm:text-xl font-semibold mb-1.5 sm:mb-2",children:"Login to Plan Your Day"}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm sm:text-base",children:"Please login to view and manage your daily study schedule."})]})});let I={};return C.forEach(s=>{I[s.startHour]||(I[s.startHour]=[]),I[s.startHour].push(s)}),(0,a.jsxs)("div",{className:"flex-grow flex flex-col p-1 sm:p-0",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 sm:mb-4 px-1 sm:px-2 gap-2",children:[(0,a.jsxs)("h2",{className:"text-lg sm:text-xl font-bold text-foreground",children:["Tasks for: ",(0,b.GP)(e,"EEEE, MMMM d, yyyy")]}),(0,a.jsxs)(u.lG,{open:S,onOpenChange:z,children:[(0,a.jsx)(u.zM,{asChild:!0,children:(0,a.jsxs)(i.$,{size:"sm",className:"w-full sm:w-auto text-xs sm:text-sm",variant:"default",children:[(0,a.jsx)(x.A,{className:"mr-1.5 h-3.5 w-3.5 sm:h-4 sm:w-4"})," Add Task"]})}),(0,a.jsxs)(u.Cf,{className:"sm:max-w-md md:max-w-lg",children:[(0,a.jsxs)(u.c7,{children:[(0,a.jsxs)(u.L3,{className:"text-base sm:text-lg",children:["Add New Task for ",(0,b.GP)(e,"EEEE")]}),(0,a.jsxs)(u.rr,{className:"text-xs sm:text-sm",children:["Fill in the details for your new study task for ",(0,b.GP)(e,"MMMM d"),". Required fields are marked with ",(0,a.jsx)("span",{className:"text-destructive",children:"*"}),"."]})]}),(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)(D,{}),children:(0,a.jsx)(E,{newTask:{...A,day:e.getDay()},onInputChange:s=>{let{name:e,value:t}=s.target;P(s=>({...s,[e]:t}))},onSelectChange:(s,e)=>{P(t=>({...t,[s]:e}))},isDayView:!0})}),(0,a.jsxs)(u.Es,{className:"mt-2 pt-3 sm:pt-4 border-t",children:[(0,a.jsx)(i.$,{variant:"outline",onClick:()=>z(!1),size:"sm",className:"text-xs sm:text-sm",children:"Cancel"}),(0,a.jsx)(i.$,{onClick:G,disabled:!A.title||!A.subject||void 0===A.startHour||void 0===A.duration,size:"sm",className:"text-xs sm:text-sm",children:"Save Task"})]})]})]})]}),0===C.length&&!M&&(0,a.jsx)(l.Zp,{className:"border-dashed flex-grow flex flex-col items-center justify-center min-h-[250px] sm:min-h-[300px] bg-muted/20",children:(0,a.jsxs)(l.Wu,{className:"text-center p-4 sm:p-6",children:[(0,a.jsx)(o.A,{className:"h-8 w-8 sm:h-10 sm:w-10 text-primary mx-auto mb-3 sm:mb-4"}),(0,a.jsxs)("h3",{className:"text-md sm:text-lg font-semibold mb-1 text-foreground",children:["No tasks for ",(0,b.GP)(e,"EEEE"),"."]}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs sm:text-sm",children:t&&"all"!==t?"No tasks for ".concat((0,y.nl)(t).name," on this day. Add one or change the filter."):"Enjoy your free day or add some tasks!"})]})}),C.length>0&&(0,a.jsx)(p.F,{className:"flex-grow pr-1 sm:pr-2",children:(0,a.jsx)("div",{className:"space-y-0",children:_.map(s=>(0,a.jsxs)("div",{className:"flex items-start py-1.5 sm:py-2 border-b last:border-b-0",children:[(0,a.jsx)("div",{className:"w-12 sm:w-16 text-[10px] sm:text-xs text-muted-foreground font-medium pt-0.5 sm:pt-1 text-right pr-1.5 sm:pr-2 shrink-0",children:(0,y.DD)(s)}),(0,a.jsx)("div",{className:"flex-grow pl-1.5 sm:pl-2 border-l min-h-[2.5rem] sm:min-h-[3rem]",children:I[s]&&I[s].length>0?I[s].map(s=>F(s)):(0,a.jsx)("div",{className:"text-[10px] sm:text-xs text-muted-foreground/70 italic h-full flex items-center",children:"No tasks scheduled."})})]},s))})})]})}}}]);