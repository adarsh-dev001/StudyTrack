"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8496],{58496:(e,t,s)=>{s.r(t),s.d(t,{PlannerView:()=>M});var r=s(95155),a=s(12115),l=s(66695),i=s(30285);let d=(0,s(40157).A)("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);var n=s(37648),c=s(58127),o=s(77223),u=s(50172),m=s(31550),x=s(18046),h=s(98328),p=s(54165),f=s(46102),j=s(66424),y=s(59434),b=s(27600),g=s(56104),N=s(35317),k=s(68856),v=s(43081),w=s(26126),T=s(34548),D=s(70831),E=s(83013),S=s(30688);let A=a.lazy(()=>s.e(1372).then(s.bind(s,21372)));function C(){return(0,r.jsxs)("div",{className:"grid gap-4 py-4 max-h-[65vh] overflow-y-auto pr-3",children:[(0,r.jsx)(k.E,{className:"h-10 w-full"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(k.E,{className:"h-10 w-full"}),(0,r.jsx)(k.E,{className:"h-10 w-full"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(k.E,{className:"h-10 w-full"}),(0,r.jsx)(k.E,{className:"h-10 w-full"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(k.E,{className:"h-10 w-full"}),(0,r.jsx)(k.E,{className:"h-10 w-full"})]}),(0,r.jsx)(k.E,{className:"h-20 w-full"})]})}function M(e){let{selectedDate:t,selectedSubjectFilter:s,onDateChange:k,onViewChange:M}=e,{currentUser:H}=(0,b.A)(),[P,z]=(0,a.useState)([]),[Z,_]=(0,a.useState)(!0),[F,L]=(0,a.useState)({priority:"medium",status:"pending",duration:1,day:t.getDay(),startHour:9,subject:v.yo[0].id}),[O,W]=(0,a.useState)(!1),[G,$]=(0,a.useState)(null),[B,I]=(0,a.useState)(null),V=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],q=Array.from({length:15},(e,t)=>t+8);(0,a.useEffect)(()=>{t&&L(e=>({...e,day:t.getDay()}))},[t]),(0,a.useEffect)(()=>{let e;if(!H||!g.db){z([]),_(!1);return}_(!0);let t=(0,N.rJ)(g.db,"users",H.uid,"plannerTasks");e=s&&"all"!==s?(0,N.P)(t,(0,N._M)("subject","==",s)):(0,N.P)(t);let r=(0,N.aQ)(e,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),z(t),_(!1)},e=>{console.error("Error fetching tasks: ",e),_(!1)});return()=>r()},[H,s]);let J=async()=>{if(!H||!g.db)return void console.error("User not logged in or DB not available");if(!F.title||!F.subject||void 0===F.day||void 0===F.startHour||void 0===F.duration)return void alert("Please fill in all required fields: Title, Subject, Day, Start Time, and Duration.");let e={userId:H.uid,title:F.title,subject:F.subject,topic:F.topic||"",description:F.description||"",duration:Number(F.duration)||1,priority:F.priority||"medium",status:"pending",day:Number(F.day),startHour:Number(F.startHour)};try{let s=(0,N.rJ)(g.db,"users",H.uid,"plannerTasks");await (0,N.gS)(s,e),H.uid&&await (0,S.T)(H.uid),L({title:"",topic:"",description:"",priority:"medium",status:"pending",duration:1,day:t.getDay(),startHour:9,subject:v.yo[0].id}),W(!1)}catch(e){console.error("Error creating task: ",e),alert("Failed to create task. Please try again.")}},Y=(e,t)=>{$(e),t.dataTransfer&&(t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",e.id))},Q=(e,t,s)=>{s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect="move"),I({day:e,hour:t})},R=e=>{I(null)},U=async(e,t)=>{if(!H||!g.db||!G||!G.id)return;let s=(0,N.H9)(g.db,"users",H.uid,"plannerTasks",G.id);try{await (0,N.mZ)(s,{day:e,startHour:t}),H.uid&&await (0,S.T)(H.uid)}catch(e){console.error("Error updating task position: ",e)}$(null),I(null)},K=async e=>{if(!H||!g.db)return;let t=P.find(t=>t.id===e);if(!t)return;let s="completed"===t.status?"pending":"completed",r=(0,N.H9)(g.db,"users",H.uid,"plannerTasks",e);try{await (0,N.mZ)(r,{status:s}),"completed"===s&&H.uid&&await (0,S.T)(H.uid)}catch(e){console.error("Error updating task status: ",e)}},X=async e=>{if(!H||!g.db||!window.confirm("Are you sure you want to delete this task?"))return;let t=(0,N.H9)(g.db,"users",H.uid,"plannerTasks",e);try{await (0,N.kd)(t),H.uid&&await (0,S.T)(H.uid)}catch(e){console.error("Error deleting task: ",e)}},ee=e=>{let s=(0,T.k)(t,{weekStartsOn:0});k((0,D.f)(s,e)),M("day")},et=e=>{let t=(0,v.nl)(e.subject),s=(0,v.kO)(e.priority),a=(0,v.DD)(e.startHour+e.duration);return(0,r.jsx)(f.Bc,{children:(0,r.jsxs)(f.m_,{delayDuration:300,children:[(0,r.jsx)(f.k$,{asChild:!0,children:(0,r.jsxs)("div",{draggable:!0,onDragStart:t=>Y(e,t),className:(0,y.cn)("rounded-md p-2 mb-1.5 cursor-move shadow-sm border relative group transition-all duration-200 ease-out transform hover:shadow-lg hover:scale-[1.01]","completed"===e.status?"opacity-60 bg-opacity-70 line-through":"opacity-100",t.color,"text-sm"),style:{minHeight:"".concat(2.25*Math.max(1,e.duration),"rem")},children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1 overflow-hidden pr-1",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(d,{className:"h-4 w-4 mr-1 opacity-50 shrink-0 group-hover:opacity-70"}),(0,r.jsx)("h4",{className:"font-semibold truncate",title:e.title,children:e.title})]}),(0,r.jsxs)("div",{className:"text-xs mt-0.5 mb-1 opacity-80",children:[(0,r.jsx)("span",{className:"font-medium",children:t.name}),e.topic&&(0,r.jsxs)("span",{className:"truncate block",title:e.topic,children:[" ",e.topic]})]}),(0,r.jsxs)("div",{className:"flex items-center text-xs opacity-70",children:[(0,r.jsx)(n.A,{className:"h-3 w-3 mr-1 shrink-0"}),(0,r.jsxs)("span",{children:[e.duration," ",1===e.duration?"hr":"hrs"]})]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center ml-1 space-y-0.5",children:[(0,r.jsx)("button",{onClick:()=>K(e.id),className:"p-0.5 rounded-full hover:bg-black/10 dark:hover:bg-white/10 transition-colors",title:"completed"===e.status?"Mark as pending":"Mark as completed",children:"completed"===e.status?(0,r.jsx)(c.A,{className:"h-4 w-4 text-green-600 dark:text-green-400"}):(0,r.jsx)(c.A,{className:"h-4 w-4 opacity-40 hover:opacity-70"})}),(0,r.jsx)("button",{onClick:()=>X(e.id),className:"p-0.5 rounded-full hover:bg-black/10 dark:hover:bg-white/10 transition-colors",title:"Delete task",children:(0,r.jsx)(o.A,{className:"h-4 w-4 text-red-500 hover:text-red-700 dark:hover:text-red-400"})})]})]}),e.priority&&(0,r.jsx)("div",{className:"mt-1.5",children:(0,r.jsx)(w.E,{variant:s.variant,className:s.className,children:s.text})})]})}),(0,r.jsxs)(f.ZI,{side:"top",align:"center",className:"w-64",children:[(0,r.jsx)("p",{className:"font-semibold text-sm",children:e.title}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Subject: ",t.name]}),e.topic&&(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Topic: ",e.topic]}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Time: ",(0,v.DD)(e.startHour)," - ",a]}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Duration: ",e.duration," hr(s)"]}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground capitalize",children:["Priority: ",e.priority]}),e.description&&(0,r.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Notes: ",e.description]})]})]})},e.id)};return(0,r.jsxs)("div",{className:"p-1 h-full flex flex-col",children:[H&&(0,r.jsx)("div",{className:"flex justify-end mb-3 px-1 shrink-0",children:(0,r.jsxs)(p.lG,{open:O,onOpenChange:W,children:[(0,r.jsx)(p.zM,{asChild:!0,children:(0,r.jsxs)(i.$,{size:"sm",variant:"default",children:[(0,r.jsx)(x.A,{className:"mr-2 h-4 w-4"})," Add Task"]})}),(0,r.jsxs)(p.Cf,{className:"sm:max-w-lg",children:[(0,r.jsxs)(p.c7,{children:[(0,r.jsx)(p.L3,{children:"Add New Study Task"}),(0,r.jsxs)(p.rr,{children:["Fill in the details for your new study task. Fields marked with ",(0,r.jsx)("span",{className:"text-destructive",children:"*"})," are required."]})]}),(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)(C,{}),children:(0,r.jsx)(A,{newTask:F,onInputChange:e=>{let{name:t,value:s}=e.target;L(e=>({...e,[t]:s}))},onSelectChange:(e,t)=>{L(s=>({...s,[e]:t}))},isDayView:!1})}),(0,r.jsxs)(p.Es,{className:"mt-2 pt-4 border-t",children:[(0,r.jsx)(i.$,{variant:"outline",onClick:()=>W(!1),children:"Cancel"}),(0,r.jsx)(i.$,{onClick:J,disabled:!F.title||!F.subject||void 0===F.day||void 0===F.startHour||void 0===F.duration,children:"Save Task"})]})]})]})}),!H&&(0,r.jsx)(l.Zp,{className:"border-dashed flex-grow flex flex-col items-center justify-center min-h-[400px] bg-muted/20",children:(0,r.jsxs)(l.Wu,{className:"pt-6 text-center p-6",children:[(0,r.jsx)("div",{className:"mx-auto rounded-full bg-primary/10 p-4 w-16 h-16 flex items-center justify-center mb-4",children:(0,r.jsx)(h.A,{className:"h-8 w-8 text-primary"})}),(0,r.jsx)("h3",{className:"text-xl font-semibold mb-2 text-foreground",children:"Login to Plan Your Studies"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-6",children:"Please login or sign up to start organizing your study schedule and track your progress."})]})}),H&&(0,r.jsx)(()=>{if(Z)return(0,r.jsx)(l.Zp,{className:"border-dashed flex-grow flex flex-col items-center justify-center min-h-[400px] bg-muted/20",children:(0,r.jsxs)(l.Wu,{className:"text-center p-6",children:[(0,r.jsx)(u.A,{className:"h-12 w-12 animate-spin text-primary mb-4"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Loading your study plan..."})]})});let e=P.filter(e=>!0);if(0===e.length&&!Z)return(0,r.jsx)(l.Zp,{className:"border-dashed flex-grow flex flex-col items-center justify-center min-h-[400px] bg-muted/20",children:(0,r.jsxs)(l.Wu,{className:"text-center p-6",children:[(0,r.jsx)("div",{className:"mx-auto rounded-full bg-primary/10 p-4 w-16 h-16 flex items-center justify-center mb-4",children:(0,r.jsx)(m.A,{className:"h-8 w-8 text-primary"})}),(0,r.jsx)("h3",{className:"text-xl font-semibold mb-2 text-foreground",children:s&&"all"!==s?"No tasks for ".concat((0,v.nl)(s).name," yet."):"Your Planner is Empty"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-6",children:s&&"all"!==s?"Add a new task for this subject or clear the filter to see all tasks.":"Get started by adding your first study task to the planner!"})]})});let a=(0,T.k)(t,{weekStartsOn:0});return(0,r.jsx)("div",{className:"overflow-auto flex-grow pb-2 -mx-1",children:(0,r.jsxs)("div",{className:"grid grid-cols-[auto_repeat(7,minmax(170px,1fr))] min-w-[1250px]",children:[(0,r.jsxs)("div",{className:"sticky left-0 bg-background z-10 border-r border-border",children:[(0,r.jsx)("div",{className:"h-12 border-b border-border"}),q.map(e=>(0,r.jsx)("div",{className:"h-24 flex items-center justify-center pr-2 text-xs font-medium text-muted-foreground border-b border-border",children:(0,r.jsxs)("span",{children:[e%12==0?12:e%12,e<12?"am":"pm"]})},"time-".concat(e)))]}),V.map((t,s)=>{let l=(0,D.f)(a,s);return(0,r.jsxs)("div",{className:"border-l border-border first:border-l-0",children:[(0,r.jsxs)("div",{onClick:()=>ee(s),className:"h-12 flex flex-col items-center justify-center font-semibold text-sm sticky top-0 bg-background z-10 border-b border-border hover:bg-muted/60 transition-colors cursor-pointer px-1 text-center",children:[(0,r.jsx)("span",{children:t}),(0,r.jsx)("span",{className:"text-xs text-muted-foreground font-normal",children:(0,E.GP)(l,"d")})]}),q.map(t=>{let a=e.filter(e=>e.day===s&&e.startHour===t),l=(null==B?void 0:B.day)===s&&(null==B?void 0:B.hour)===t;return(0,r.jsx)("div",{className:(0,y.cn)("h-24 p-1 relative border-b border-border",l?"bg-accent/70 ring-1 ring-primary":"bg-muted/20 hover:bg-muted/40",a.length>0?"":"border-dashed border-border/60"),onDragOver:e=>Q(s,t,e),onDragLeave:R,onDrop:()=>U(s,t),children:(0,r.jsx)(j.F,{className:"h-full",children:(0,r.jsx)("div",{className:"p-px",children:a.length>0?a.map(e=>et(e)):l&&G&&(0,r.jsx)("div",{className:"h-full flex items-center justify-center text-muted-foreground text-xs opacity-70",children:"Drop here"})})})},"".concat(s,"-").concat(t))})]},t)})]})})},{}),H&&P.length>0&&(0,r.jsxs)(l.Zp,{className:"mt-3 shrink-0",children:[(0,r.jsx)(l.aR,{className:"pb-2 pt-4",children:(0,r.jsx)(l.ZB,{className:"text-sm font-semibold",children:"Subject Color Legend"})}),(0,r.jsx)(l.Wu,{className:"pb-4",children:(0,r.jsx)("div",{className:"flex flex-wrap gap-x-3 gap-y-2",children:v.yo.map(e=>(0,r.jsx)("div",{className:(0,y.cn)("px-2 py-0.5 rounded-full text-xs flex items-center border text-center",e.color),children:e.name},e.id))})})]})]})}},98328:(e,t,s)=>{s.d(t,{A:()=>r});let r=(0,s(40157).A)("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]])}}]);